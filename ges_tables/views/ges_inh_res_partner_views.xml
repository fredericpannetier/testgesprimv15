<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="ges_res_partner_action_customer" model="ir.actions.act_window"><!-- standard + ajout filtre dans contexte -->
        <field name="name">Customers</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="context">{'search_default_customer': 1,'res_partner_search_mode': 'customer', 'default_is_company': True,
                                'default_customer_rank': 1, 'search_default_di_filter_parent_partner': 1}
        </field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a new customer in your address book
          </p><p>
            Odoo helps you easily track all activities related to a customer.
          </p>
        </field>
    </record>
    <record id="ges_res_partner_action_supplier" model="ir.actions.act_window"><!-- standard + ajout filtre dans contexte -->
        <field name="name">Vendors</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="context">{'search_default_supplier': 1,'res_partner_search_mode': 'supplier', 'default_is_company': True,
                                'default_supplier_rank': 1, 'search_default_di_filter_parent_partner': 1}
        </field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a new supplier in your address book
          </p><p>
            Odoo helps you easily track all activities related to a supplier.
          </p>
        </field>
    </record>   
    
    <record id="ges_view_partner_property_form" model="ir.ui.view">
        <field name="name">ges.res.partner.property.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="account.view_partner_property_form" />
        <field eval="80" name="priority" />
        <field name="arch" type="xml">
            <!-- on ajoute un champs invisible -->
            <xpath expr="//group[@name='accounting_entries']" position="replace">
                <group string="Accounting Entries" name="accounting_entries" groups="account.group_account_readonly">
                    <field name="currency_id" invisible="1" />
                    <field name="customer_rank" invisible="1" />
                    <field name="supplier_rank" invisible="1" />
                    <field name="property_account_receivable_id" attrs="{'invisible': [('customer_rank','=', 0)]}"/>
                    <field name="property_account_payable_id" attrs="{'invisible': [('supplier_rank','=', 0)]}"/>
                </group>
            </xpath>           
            <xpath expr="//group[@name='sale']" position="attributes">
                <attribute name="attrs" >{'invisible': [('customer_rank','=', 0)]}</attribute>
            </xpath>
            <xpath expr="//group[@name='purchase']" position="attributes">
                <attribute name="attrs" >{'invisible': [('supplier_rank','=', 0)]}</attribute>
            </xpath>
            <xpath expr="//page[@name='sales_purchases']/group" position="inside">
                    <group name="container_row_stock"  priority="6">
                        <group string="Printing" name="ges_printing" colspan="2">
                            <field name="ges_val_deliv" />
                            <field name="ges_order_copies" />
                            <field name="ges_deliv_copies" />
                            <field name="ges_inv_copies" />                                   
                        </group>
                    </group>
            </xpath>
            <xpath expr="//group[@name='sale']" position="inside">
                <field name="ges_deliverydelay" />                
            </xpath>
        </field>                      
    </record> 
    <record id="ges_view_partner_form" model="ir.ui.view">
        <field name="name">ges.view.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form" />
        <field eval="79" name="priority" />
        <field name="arch" type="xml">            
            <xpath expr="//sheet//field[@name='name']" position="replace">
                <field name="name" default_focus="1" placeholder="Name" attrs="{'required' : [('type', '=', 'contact')]}"/>                
            </xpath>                                   

        </field>                      
    </record> 
    <record id="ges_res_partner_view_purchase_buttons" model="ir.ui.view">
        <field name="name">ges.res.partner.view.purchase.buttons</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="purchase.res_partner_view_purchase_buttons" />
        <field eval="79" name="priority" />
        <field name="arch" type="xml">            
            <xpath expr="//button[@name='%(purchase.act_res_partner_2_purchase_order)d']" position="attributes">
                <attribute name="attrs">{'invisible': [('supplier_rank','=', 0)]}</attribute>
            </xpath>                                   

        </field>                      
    </record> 
    <record id="ges_res_partner_view_purchase_account_buttons" model="ir.ui.view">
        <field name="name">ges.res.partner.view.purchase.account.buttons</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="purchase.res_partner_view_purchase_account_buttons" />
        <field eval="79" name="priority" />
        <field name="arch" type="xml">            
            <xpath expr="//button[@name='%(purchase.act_res_partner_2_supplier_invoices)d']" position="attributes">
                <attribute name="attrs">{'invisible': [('supplier_rank','=', 0)]}</attribute>
            </xpath>                                   

        </field>                      
    </record> 
    <record id="ges_res_partner_view_sale_buttons" model="ir.ui.view">
        <field name="name">ges.res.partner.view.sale.buttons</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="sale.res_partner_view_buttons" />
        <field eval="79" name="priority" />
        <field name="arch" type="xml">            
            <xpath expr="//button[@name='%(sale.act_res_partner_2_sale_order)d']" position="attributes">
                <attribute name="attrs">{'invisible': [('customer_rank','=', 0)]}</attribute>
            </xpath>                                   

        </field>                      
    </record> 
    
    <record id="di_view_partner_tree" model="ir.ui.view">
            <field name="name">di.view_partner_tree</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_tree"/>
            <field eval="80" name="priority"/>
            <field name="arch" type="xml">
                <!-- ajout code tiers -->
                <xpath expr="//tree" position="inside">
                    <field name="zip" string="Zip code" options="{'no_open': True}"/>
                </xpath>                
            </field>
        </record>               
</odoo>
